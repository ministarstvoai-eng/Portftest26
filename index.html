<!doctype html>
<html lang="sr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Portfolio</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@500;600;700;800&display=swap" rel="stylesheet">

  <style>
    :root{
      --bg:#070709;
      --text:#f2f2f2;
      --muted:rgba(242,242,242,.70);

      --border:rgba(255,255,255,.10);
      --border2:rgba(255,255,255,.22);

      --shadow: 0 24px 80px rgba(0,0,0,.62);
      --r:18px;

      /* AFTER pulse colors */
      --aStroke1: rgba(120,255,210,.48);
      --aStroke2: rgba(120,255,210,.78);
      --aGlow1: rgba(120,255,210,.10);
      --aGlow2: rgba(120,255,210,.20);
      --aGlow3: rgba(120,170,255,.08);
      --aGlow4: rgba(120,170,255,.14);

      /* Header glass */
      --glass: rgba(16,16,20,.62);
      --glass2: rgba(255,255,255,.06);
    }

    *{ box-sizing:border-box; }
    html, body{ height:100%; }
    body{
      margin:0;
      font-family:"Manrope", Arial, sans-serif;
      color:var(--text);
      background:
        /* NEW: subtle premium radial gradients */
        radial-gradient(900px 500px at 15% -5%, rgba(120,90,255,.13), transparent 60%),
        radial-gradient(800px 480px at 85% 10%, rgba(0,200,255,.10), transparent 58%),
        radial-gradient(900px 600px at 50% 110%, rgba(255,255,255,.05), transparent 60%),
        var(--bg);
    }

    .wrap{
      max-width:1240px;
      margin:0 auto;
      padding: 0 18px 86px; /* top padding moved to sticky header spacer */
    }

    /* =========================
       Sticky header (floating)
       ========================= */
    .sticky{
      position: sticky;
      top: 0;
      z-index: 200;
      padding: 14px 0 12px;
      background: linear-gradient(180deg, rgba(7,7,9,.90), rgba(7,7,9,.55) 70%, rgba(7,7,9,0));
      backdrop-filter: blur(10px);
    }

    .headerCard{
      max-width:1240px;
      margin: 0 auto;
      padding: 14px 14px 12px;
      border-radius: 18px;
      background: var(--glass);
      outline: 1px solid rgba(255,255,255,.10);
      box-shadow: 0 18px 60px rgba(0,0,0,.35);
      backdrop-filter: blur(14px);
      transform-origin: top center;
      animation: headerIn .42s ease-out both;
    }

    @keyframes headerIn{
      from{ opacity:0; transform: translateY(-10px) scale(.99); }
      to  { opacity:1; transform: translateY(0) scale(1); }
    }

    /* top row */
    .top{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
    }

    .titleWrap{
      flex:1;
      text-align:center;
      min-width: 160px;
    }

    .title{
      font-size: 34px;          /* bigger */
      font-weight: 800;         /* bolder */
      letter-spacing: .5px;
      margin: 4px 0 6px;
      text-shadow: 0 12px 50px rgba(0,0,0,.35);
      animation: titleFade .6s ease-out both;
      animation-delay: .05s;
    }

    @keyframes titleFade{
      from{ opacity:0; transform: translateY(-6px); }
      to  { opacity:1; transform: translateY(0); }
    }

    /* Visual marker under title */
    .marker{
      width: min(340px, 70%);
      height: 2px;
      margin: 0 auto 2px;
      border-radius: 999px;
      background: linear-gradient(90deg,
        rgba(255,255,255,0),
        rgba(120,255,210,.55),
        rgba(120,170,255,.35),
        rgba(255,255,255,0)
      );
      box-shadow: 0 0 18px rgba(120,255,210,.10);
      opacity: .95;
      animation: markerGlow 2.6s ease-in-out infinite;
    }

    @keyframes markerGlow{
      0%,100%{ opacity:.65; }
      50%{ opacity:1; }
    }

    .actions{
      display:flex;
      gap:10px;
      align-items:center;
      justify-content:flex-end;
      min-width:260px;
    }

    .btn{
      border:0;
      cursor:pointer;
      color:#fff;
      padding:11px 13px;
      border-radius:14px;
      font-size:13px;
      font-weight: 650;
      display:flex;
      gap:8px;
      align-items:center;
      white-space:nowrap;
      background: rgba(255,255,255,.10);
      outline: 1px solid rgba(255,255,255,.12);
      transition: transform .18s ease, background .18s ease, outline-color .18s ease;
      user-select:none;
    }
    .btn:hover{
      transform: translateY(-1px);
      background: rgba(255,255,255,.14);
      outline-color: rgba(255,255,255,.20);
    }
    .btn:active{ transform: translateY(0) scale(.99); }
    .btn.on{ background: rgba(255,255,255,.16); }

    /* Filters - bigger & more visible */
    .filters{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      justify-content:center;
      margin-top: 10px;
      padding-top: 10px;
      border-top: 1px solid rgba(255,255,255,.08);
    }
    .chip{
      border:0;
      cursor:pointer;
      padding: 10px 14px;
      border-radius:999px;
      font-size: 14px;         /* bigger */
      font-weight: 700;        /* bolder */
      letter-spacing: .15px;
      color: rgba(255,255,255,.92);
      background: rgba(255,255,255,.08);
      outline: 1px solid rgba(255,255,255,.12);
      transition: background .18s ease, transform .18s ease, outline-color .18s ease, box-shadow .18s ease;
      user-select:none;
      display:flex;
      align-items:center;
      gap:8px;
    }
    .chip:hover{
      background: rgba(255,255,255,.12);
      outline-color: rgba(255,255,255,.18);
      transform: translateY(-1px);
    }
    /* Option B: active filter POPS */
    .chip.active{
      background: rgba(255,255,255,.18);
      outline-color: rgba(255,255,255,.28);
      box-shadow:
        0 0 0 1px rgba(255,255,255,.06) inset,
        0 0 22px rgba(120,255,210,.10);
      transform: translateY(-1px);
    }
    .chip.bump{
      animation: chipBump .22s ease-out;
    }
    @keyframes chipBump{
      0%{ transform: translateY(-1px) scale(1); }
      45%{ transform: translateY(-2px) scale(1.05); }
      100%{ transform: translateY(-1px) scale(1); }
    }

    /* spacer between header and grid */
    .spacer{ height: 14px; }

    /* =========================
       Grid
       ========================= */
    .grid{
      display:grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 16px;
      overflow: visible;
    }
    .grid.isFew{ max-width: 980px; margin: 0 auto; }
    .grid:hover .card{ opacity: .82; filter: saturate(.98); }

    .card{
      position: relative;
      height: 270px; /* slightly bigger thumbnails */
      border-radius: var(--r);
      overflow: visible;
      cursor: pointer;
      transition: opacity .18s ease;
      animation: fadeUp .28s ease both;
    }
    @keyframes fadeUp{
      from{ opacity:0; transform:translateY(10px); }
      to  { opacity:1; transform:translateY(0); }
    }
    @media (min-width: 980px){
      .card:nth-child(6n){ height: 310px; }
    }

    .card-inner{
      position: relative;
      width: 100%;
      height: 100%;
      border-radius: var(--r);
      overflow: hidden;
      background: linear-gradient(180deg, rgba(255,255,255,.03), rgba(255,255,255,.01));
      outline: 1px solid var(--border);
      transition: transform .22s ease, box-shadow .22s ease, outline-color .22s ease;
      will-change: transform;
    }
    .card:hover{ opacity: 1 !important; z-index: 10; }
    .card:hover .card-inner{
      transform: scale(1.07);
      box-shadow: var(--shadow);
      outline-color: var(--border2);
    }

    .media{
      width:100%;
      height:100%;
      object-fit: cover;
      display:block;
      background:#000;
      transform: scale(1.01);
    }

    .typeIcon{
      position:absolute;
      left:10px;
      top:10px;
      width:36px;
      height:36px;
      border-radius:12px;
      display:flex;
      align-items:center;
      justify-content:center;
      background:rgba(0,0,0,.42);
      outline:1px solid rgba(255,255,255,.10);
      backdrop-filter: blur(10px);
      pointer-events:none;
      font-size:14px;
      z-index:5;
    }

    .caption{
      position:absolute;
      left:12px; right:12px; bottom:12px;
      padding: 10px 12px;
      border-radius: 14px;
      background: rgba(0,0,0,.46);
      outline: 1px solid rgba(255,255,255,.10);
      backdrop-filter: blur(10px);
      transform: translateY(8px);
      opacity: 0;
      transition: opacity .20s ease, transform .20s ease;
      pointer-events:none;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      z-index:5;
    }
    .card:hover .caption{ opacity: 1; transform: translateY(0); }

    .capText{
      overflow:hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
      font-size: 12px;
      color: rgba(255,255,255,.92);
      font-weight: 650;
      letter-spacing: .1px;
    }
    .capTag{ font-size: 11px; color: rgba(255,255,255,.70); white-space: nowrap; }

    /* Pair */
    .pair{
      width:100%;
      height:100%;
      display:grid;
      grid-template-columns:1fr 1fr;
      background:#000;
      position:relative;
    }
    .pair img{
      width:100%;
      height:100%;
      object-fit:cover;
      display:block;
      background:#000;
    }
    .divider{
      position:absolute;
      left:50%;
      top:0; bottom:0;
      width:1px;
      background: rgba(255,255,255,.18);
      pointer-events:none;
      z-index:4;
    }
    .pairLabel{
      position:absolute;
      top:10px;
      padding:7px 10px;
      border-radius:999px;
      background: rgba(0,0,0,.46);
      outline: 1px solid rgba(255,255,255,.10);
      font-size: 12px;
      backdrop-filter: blur(10px);
      pointer-events:none;
      opacity:.92;
      letter-spacing:.2px;
      z-index:5;
    }
    .pairLabel.before{ left:56px; }
    .pairLabel.after{ right:10px; }

    /* AFTER pulse (hover-only) ‚Äî no circles, no overlay */
    .afterShine{
      position:absolute;
      top:10px; bottom:10px;
      left:calc(50% + 10px); right:10px;
      border-radius:14px;
      pointer-events:none;
      opacity:0;
      z-index:6;
    }
    .afterShine::before{
      content:"";
      position:absolute;
      inset:0;
      border-radius:14px;
      border:2px solid var(--aStroke1);
      box-shadow: 0 0 0 1px rgba(120,255,210,.12) inset;
      opacity:.85;
    }
    .afterShine::after{
      content:"";
      position:absolute;
      inset:-10px;
      border-radius:20px;
      box-shadow:
        0 0 14px var(--aGlow1),
        0 0 28px var(--aGlow3);
      opacity:0;
      transform: scale(.99);
    }

    .card:hover .afterShine{ opacity: 1; }
    .card:hover .afterShine::before{ animation: afterStrokePulse 1.25s ease-in-out infinite; }
    .card:hover .afterShine::after { opacity: 1; animation: afterGlowPulse 1.25s ease-in-out infinite; }

    @keyframes afterStrokePulse{
      0%,100%{
        border-color: var(--aStroke1);
        opacity: .72;
        filter: saturate(1) hue-rotate(0deg);
      }
      50%{
        border-color: var(--aStroke2);
        opacity: 1;
        filter: saturate(1.18) hue-rotate(14deg);
      }
    }
    @keyframes afterGlowPulse{
      0%,100%{
        transform: scale(.985);
        box-shadow:
          0 0 12px var(--aGlow1),
          0 0 24px var(--aGlow3);
        opacity: .75;
      }
      50%{
        transform: scale(1.01);
        box-shadow:
          0 0 22px var(--aGlow2),
          0 0 44px var(--aGlow4);
        opacity: 1;
      }
    }

    /* ===== Contact dialog ===== */
    .overlay{
      position:fixed; inset:0;
      display:none;
      align-items:center; justify-content:center;
      padding:18px;
      background:rgba(0,0,0,.70);
      z-index:220;
    }
    .overlay.open{ display:flex; }
    .dialog{
      width:min(540px, 96vw);
      border-radius:18px;
      background:
        radial-gradient(900px 300px at 20% -10%, rgba(120,90,255,.25), transparent 55%),
        radial-gradient(900px 300px at 90% 10%, rgba(0,200,255,.18), transparent 55%),
        rgba(15,15,18,.95);
      outline:1px solid rgba(255,255,255,.12);
      box-shadow:0 35px 120px rgba(0,0,0,.65);
      overflow:hidden;
      transform:translateY(14px) scale(.98);
      opacity:0;
      transition:transform .22s ease, opacity .22s ease;
    }
    .overlay.open .dialog{ transform:translateY(0) scale(1); opacity:1; }
    .dialogTop{
      display:flex; align-items:center; justify-content:space-between;
      padding:12px 12px;
      background:rgba(255,255,255,.03);
    }
    .dialogTop b{ font-size:13px; opacity:.92; }
    .xbtn{
      border:0; cursor:pointer;
      padding:8px 10px;
      border-radius:12px;
      background:rgba(255,255,255,.10);
      color:#fff;
      outline:1px solid rgba(255,255,255,.10);
      transition:transform .18s ease, background .18s ease;
    }
    .xbtn:hover{ transform:translateY(-1px); background:rgba(255,255,255,.14); }
    .xbtn:active{ transform:translateY(0) scale(.99); }
    .dialogBody{ padding:16px 14px 14px; }
    .sub{ font-size:12px; color:rgba(255,255,255,.70); margin:0; line-height:1.35; }
    .emailBox{
      display:flex; align-items:center; justify-content:space-between;
      gap:10px;
      padding:12px 12px;
      border-radius:14px;
      background:rgba(255,255,255,.06);
      outline:1px solid rgba(255,255,255,.10);
      margin-top:10px;
    }
    .email{
      font-weight:650;
      letter-spacing:.2px;
      font-size:13px;
      color:rgba(255,255,255,.92);
      overflow:hidden;
      text-overflow:ellipsis;
      white-space:nowrap;
    }
    .rowBtns{ display:flex; gap:8px; align-items:center; }
    .copyBtn, .mailBtn{
      border:0; cursor:pointer;
      padding:10px 12px;
      border-radius:12px;
      background:rgba(255,255,255,.12);
      color:#fff;
      outline:1px solid rgba(255,255,255,.12);
      font-size:12px;
      transition:transform .18s ease, background .18s ease;
      user-select:none;
      white-space:nowrap;
      text-decoration:none;
      display:inline-flex;
      align-items:center;
      justify-content:center;
      gap:8px;
    }
    .copyBtn:hover, .mailBtn:hover{ transform:translateY(-1px); background:rgba(255,255,255,.16); }
    .copyBtn:active, .mailBtn:active{ transform:translateY(0) scale(.99); }

    .toast{
      position:fixed;
      left:50%; bottom:22px;
      transform:translateX(-50%) translateY(10px);
      opacity:0;
      padding:10px 12px;
      border-radius:999px;
      background:rgba(0,0,0,.55);
      outline:1px solid rgba(255,255,255,.12);
      color:#fff;
      font-size:12px;
      backdrop-filter:blur(10px);
      transition:opacity .18s ease, transform .18s ease;
      z-index:240;
      pointer-events:none;
    }
    .toast.show{ opacity:1; transform:translateX(-50%) translateY(0); }

    /* ===== Viewer modal ===== */
    .modal{
      position:fixed; inset:0; display:none;
      background:rgba(0,0,0,.74);
      padding:18px;
      align-items:center; justify-content:center;
      z-index:230;
    }
    .modal.open{ display:flex; }
    .modal-inner{
      width:min(1100px, 96vw);
      background:rgba(15,15,18,.96);
      border-radius:18px;
      overflow:hidden;
      outline:1px solid rgba(255,255,255,.10);
      box-shadow:0 35px 120px rgba(0,0,0,.65);
      transform:translateY(10px) scale(.99);
      opacity:0;
      transition:transform .20s ease, opacity .20s ease;
    }
    .modal.open .modal-inner{ transform:translateY(0) scale(1); opacity:1; }
    .modal-top{
      display:flex; align-items:center; justify-content:space-between;
      padding:10px 12px;
      background:rgba(255,255,255,.03);
    }
    .modal-top b{ font-size:13px; opacity:.9; }
    .close{
      border:0; cursor:pointer;
      background:rgba(255,255,255,.10);
      color:#fff;
      padding:8px 10px;
      border-radius:12px;
      outline:1px solid rgba(255,255,255,.10);
      transition:transform .18s ease, background .18s ease;
    }
    .close:hover{ transform:translateY(-1px); background:rgba(255,255,255,.14); }
    .close:active{ transform:translateY(0) scale(.99); }

    .viewer{
      width:100%;
      background:#000;
      display:flex;
      align-items:center;
      justify-content:center;
      max-height:78vh;
      position:relative;
    }
    .viewer video{
      width:100%;
      height:100%;
      max-height:78vh;
      object-fit:contain;
      background:#000;
    }
    .viewer img{
      width:100%;
      height:auto;
      max-height:78vh;
      object-fit:contain;
      background:#000;
      display:block;
    }
    .viewerPair{
      width:100%;
      display:grid;
      grid-template-columns:1fr 1fr;
      background:#000;
      max-height:78vh;
      position:relative;
    }
    .viewerPair img{
      width:100%;
      height:78vh;
      object-fit:contain;
      background:#000;
      display:block;
    }
    .viewerDivider{
      position:absolute;
      left:50%;
      top:0;
      bottom:0;
      width:1px;
      background:rgba(255,255,255,.18);
      pointer-events:none;
      z-index:2;
    }
    .viewerAfterShine{
      position:absolute;
      top:14px; bottom:14px;
      left:calc(50% + 14px); right:14px;
      border-radius:16px;
      pointer-events:none;
      z-index:3;
    }
    .viewerAfterShine::before{
      content:"";
      position:absolute;
      inset:0;
      border-radius:16px;
      border:2px solid var(--aStroke1);
      box-shadow: 0 0 0 1px rgba(120,255,210,.12) inset;
      animation: afterStrokePulse 1.35s ease-in-out infinite;
      opacity:.95;
    }
    .viewerAfterShine::after{
      content:"";
      position:absolute;
      inset:-12px;
      border-radius:24px;
      animation: afterGlowPulse 1.35s ease-in-out infinite;
      opacity:.95;
    }

    /* Responsive */
    @media (max-width: 980px){
      .title{ font-size: 30px; }
      .actions{ min-width: unset; }
    }
    @media (max-width: 820px){
      .wrap{ padding: 0 14px 70px; }
      .headerCard{ padding: 12px 12px 10px; border-radius: 16px; }

      .title{ font-size: 26px; }
      .actions{ gap:8px; }

      .grid{ grid-template-columns: 1fr; }
      .card{ height: 245px; }
      .card:hover .card-inner{ transform: scale(1.04); }

      .viewerPair{ grid-template-columns:1fr; }
      .viewerPair img{ height:auto; max-height:78vh; }
      .viewerDivider, .viewerAfterShine{ display:none; }
      .pairLabel.before{ left:10px; top:52px; }
      .filters{ gap:8px; }
    }

    /* make sure content doesn't hide under sticky on tiny screens */
    .contentTopPad{ padding-top: 14px; }
  </style>
</head>

<body>
  <!-- Sticky header -->
  <div class="sticky">
    <div class="headerCard">
      <div class="top">
        <div style="width:260px;"></div>

        <div class="titleWrap">
          <div class="title">Test portfolio</div>
          <div class="marker"></div>
        </div>

        <div class="actions">
          <button class="btn" id="contactBtn">‚úâÔ∏è Contact me</button>
          <button class="btn" id="soundBtn" title="Ukljuƒçi UI zvuk (hover/klik)">
            üîä <span id="soundLabel">Sound OFF</span>
          </button>
        </div>
      </div>

      <div class="filters" id="filters">
        <button class="chip active" data-filter="all">‚óè All</button>
        <button class="chip" data-filter="video">‚ñ∂ Video</button>
        <button class="chip" data-filter="photo">‚ñ¢ Photo</button>
      </div>
    </div>
  </div>

  <div class="wrap contentTopPad">
    <div class="spacer"></div>
    <div class="grid" id="grid"></div>
  </div>

  <!-- Contact dialog -->
  <div class="overlay" id="contactOverlay" aria-hidden="true">
    <div class="dialog" role="dialog" aria-modal="true" aria-labelledby="contactTitle">
      <div class="dialogTop">
        <b id="contactTitle">Contact</b>
        <button class="xbtn" id="contactClose">Close</button>
      </div>
      <div class="dialogBody">
        <p class="sub">Mo≈æe≈° me kontaktirati ovdje ‚Äî kopiraj email ili otvori mail app.</p>
        <div class="emailBox">
          <div class="email" id="emailText">primjer@nestobzv.com</div>
          <div class="rowBtns">
            <button class="copyBtn" id="copyBtn">Copy</button>
            <a class="mailBtn" href="mailto:primjer@nestobzv.com">Open</a>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="toast" id="toast">Copied ‚úì</div>

  <!-- Viewer modal -->
  <div class="modal" id="modal">
    <div class="modal-inner">
      <div class="modal-top">
        <b id="modalTitle">Viewer</b>
        <button class="close" id="closeBtn">Close</button>
      </div>
      <div class="viewer" id="viewer"></div>
    </div>
  </div>

  <script>
    // ==========================
    // UPISI SVOJE FAJLOVE OVDJE
    // Folderi:
    //   /videos
    //   /images
    // ==========================
    const ITEMS = [
      // Videos
      { type: "video", src: "./videos/v1.mp4", caption: "Primjer blabla" },
      { type: "video", src: "./videos/v2.mp4", caption: "Primjer blabla" },
      { type: "video", src: "./videos/v3.mp4", caption: "Primjer blabla" },
      { type: "video", src: "./videos/v4.mp4", caption: "Primjer blabla" },
      { type: "video", src: "./videos/v5.mp4", caption: "Primjer blabla" },

      // Photos (single)
      { type: "photo", src: "./images/p2.png", caption: "Primjer blabla" },

      // Before/After pairs
      { type: "pair", before: "./images/p1_before.png", after: "./images/p1_after.png", caption: "Primjer blabla" },
      { type: "pair", before: "./images/p3_before.png", after: "./images/p3_after.png", caption: "Primjer blabla" },
    ];

    // ==========================
    // UI SOUND (WebAudio)
    // ==========================
    let soundEnabled = false;
    let audioCtx = null;

    function ensureAudio(){
      if(!audioCtx){
        audioCtx = new (window.AudioContext || window.webkitAudioContext)();
      }
      if(audioCtx.state === "suspended"){
        audioCtx.resume().catch(()=>{});
      }
    }

    function hoverTick(){
      if(!soundEnabled) return;
      ensureAudio();
      const now = audioCtx.currentTime;

      const o = audioCtx.createOscillator();
      const g = audioCtx.createGain();
      o.type = "sine";
      o.frequency.setValueAtTime(820, now);
      g.gain.setValueAtTime(0.0001, now);
      g.gain.exponentialRampToValueAtTime(0.020, now + 0.005);
      g.gain.exponentialRampToValueAtTime(0.0001, now + 0.030);

      o.connect(g);
      g.connect(audioCtx.destination);
      o.start(now);
      o.stop(now + 0.04);
    }

    function softClick(){
      if(!soundEnabled) return;
      ensureAudio();
      const now = audioCtx.currentTime;

      const bufferSize = Math.floor(audioCtx.sampleRate * 0.04);
      const buffer = audioCtx.createBuffer(1, bufferSize, audioCtx.sampleRate);
      const data = buffer.getChannelData(0);
      for(let i=0;i<bufferSize;i++){
        data[i] = (Math.random()*2-1) * Math.exp(-i / (bufferSize/6));
      }

      const src = audioCtx.createBufferSource();
      src.buffer = buffer;

      const filter = audioCtx.createBiquadFilter();
      filter.type = "lowpass";
      filter.frequency.setValueAtTime(1200, now);
      filter.Q.setValueAtTime(0.8, now);

      const g = audioCtx.createGain();
      g.gain.setValueAtTime(0.0001, now);
      g.gain.exponentialRampToValueAtTime(0.08, now + 0.005);
      g.gain.exponentialRampToValueAtTime(0.0001, now + 0.040);

      src.connect(filter);
      filter.connect(g);
      g.connect(audioCtx.destination);

      src.start(now);
      src.stop(now + 0.05);
    }

    // Buttons
    const soundBtn = document.getElementById("soundBtn");
    const soundLabel = document.getElementById("soundLabel");
    soundBtn.addEventListener("click", () => {
      soundEnabled = !soundEnabled;
      if(soundEnabled){
        ensureAudio();
        soundBtn.classList.add("on");
        soundLabel.textContent = "Sound ON";
        softClick();
      } else {
        soundBtn.classList.remove("on");
        soundLabel.textContent = "Sound OFF";
      }
    });

    // ==========================
    // CONTACT MODAL
    // ==========================
    const contactBtn = document.getElementById("contactBtn");
    const contactOverlay = document.getElementById("contactOverlay");
    const contactClose = document.getElementById("contactClose");
    const emailText = document.getElementById("emailText");
    const copyBtn = document.getElementById("copyBtn");
    const toast = document.getElementById("toast");

    function openContact(){
      contactOverlay.classList.add("open");
      contactOverlay.setAttribute("aria-hidden","false");
      softClick();
    }
    function closeContact(){
      contactOverlay.classList.remove("open");
      contactOverlay.setAttribute("aria-hidden","true");
    }

    contactBtn.addEventListener("click", openContact);
    contactClose.addEventListener("click", () => { softClick(); closeContact(); });
    contactOverlay.addEventListener("click", (e) => {
      if(e.target === contactOverlay){ softClick(); closeContact(); }
    });

    copyBtn.addEventListener("click", async () => {
      softClick();
      try{
        await navigator.clipboard.writeText(emailText.textContent.trim());
        toast.textContent = "Copied ‚úì";
      }catch(e){
        toast.textContent = "Copy not allowed";
      }
      toast.classList.add("show");
      setTimeout(() => toast.classList.remove("show"), 1400);
    });

    // ==========================
    // FILTERS + RENDER
    // ==========================
    const grid = document.getElementById("grid");
    const filterWrap = document.getElementById("filters");
    let currentFilter = "all";
    let visibleItems = [];

    filterWrap.addEventListener("click", (e) => {
      const btn = e.target.closest(".chip");
      if(!btn) return;

      currentFilter = btn.dataset.filter;
      document.querySelectorAll(".chip").forEach(c => c.classList.remove("active","bump"));
      btn.classList.add("active","bump");

      softClick();
      render();
    });

    function getFiltered(){
      if(currentFilter === "all") return ITEMS.slice();
      if(currentFilter === "video") return ITEMS.filter(x => x.type === "video");
      if(currentFilter === "photo") return ITEMS.filter(x => x.type === "photo" || x.type === "pair");
      return ITEMS.slice();
    }

    function updateGridFewClass(){
      visibleItems.length <= 2 ? grid.classList.add("isFew") : grid.classList.remove("isFew");
    }

    function createCard(item){
      const card = document.createElement("div");
      card.className = "card";

      const inner = document.createElement("div");
      inner.className = "card-inner";

      card.addEventListener("mouseenter", () => hoverTick());

      // Type icon
      const icon = document.createElement("div");
      icon.className = "typeIcon";
      icon.textContent = item.type === "video" ? "‚ñ∂" : (item.type === "pair" ? "‚áÑ" : "‚ñ¢");
      inner.appendChild(icon);

      if(item.type === "video"){
        const v = document.createElement("video");
        v.className = "media";
        v.src = item.src;
        v.muted = true;
        v.loop = true;
        v.playsInline = true;
        v.preload = "metadata";
        inner.appendChild(v);

        card.addEventListener("mouseenter", async () => {
          try{ v.currentTime = 0; await v.play(); }catch(e){}
        });
        card.addEventListener("mouseleave", () => {
          v.pause();
          v.currentTime = 0;
        });

      } else if(item.type === "photo"){
        const img = document.createElement("img");
        img.className = "media";
        img.src = item.src;
        img.alt = "Photo";
        img.loading = "lazy";
        img.decoding = "async";
        inner.appendChild(img);

      } else if(item.type === "pair"){
        const pair = document.createElement("div");
        pair.className = "pair";

        const b = document.createElement("img");
        b.src = item.before; b.alt = "Before"; b.loading = "lazy"; b.decoding = "async";
        const a = document.createElement("img");
        a.src = item.after; a.alt = "After"; a.loading = "lazy"; a.decoding = "async";

        pair.appendChild(b);
        pair.appendChild(a);
        inner.appendChild(pair);

        const divider = document.createElement("div");
        divider.className = "divider";
        inner.appendChild(divider);

        const lb = document.createElement("div");
        lb.className = "pairLabel before";
        lb.textContent = "BEFORE";
        const la = document.createElement("div");
        la.className = "pairLabel after";
        la.textContent = "AFTER";
        inner.appendChild(lb);
        inner.appendChild(la);

        // AFTER pulse frame (hover only)
        const shine = document.createElement("div");
        shine.className = "afterShine";
        inner.appendChild(shine);
      }

      // Caption overlay
      const cap = document.createElement("div");
      cap.className = "caption";
      cap.innerHTML = `<div class="capText">${item.caption || "Primjer blabla"}</div>
                       <div class="capTag">${item.type === "video" ? "VIDEO" : (item.type === "pair" ? "BEFORE/AFTER" : "PHOTO")}</div>`;
      inner.appendChild(cap);

      card.appendChild(inner);

      card.addEventListener("click", () => {
        softClick();
        const idx = visibleItems.findIndex(x => x === item);
        openViewer(item, idx);
      });

      return card;
    }

    function render(){
      grid.innerHTML = "";
      visibleItems = getFiltered();
      updateGridFewClass();
      visibleItems.forEach((item) => grid.appendChild(createCard(item)));
    }

    // ==========================
    // VIEWER MODAL + keyboard nav
    // ==========================
    const modal = document.getElementById("modal");
    const viewer = document.getElementById("viewer");
    const closeBtn = document.getElementById("closeBtn");
    const modalTitle = document.getElementById("modalTitle");
    let currentIndex = -1;

    function openViewer(item, index){
      viewer.innerHTML = "";
      currentIndex = index;

      if(item.type === "video"){
        modalTitle.textContent = "Video";
        const v = document.createElement("video");
        v.src = item.src;
        v.controls = true;
        v.playsInline = true;
        v.muted = false;
        v.currentTime = 0;
        viewer.appendChild(v);
        modal.classList.add("open");
        v.play().catch(()=>{});

      } else if(item.type === "photo"){
        modalTitle.textContent = "Photo";
        const img = document.createElement("img");
        img.src = item.src;
        img.alt = "Photo";
        viewer.appendChild(img);
        modal.classList.add("open");

      } else if(item.type === "pair"){
        modalTitle.textContent = "Before / After";
        const pair = document.createElement("div");
        pair.className = "viewerPair";

        const b = document.createElement("img");
        b.src = item.before; b.alt = "Before";
        const a = document.createElement("img");
        a.src = item.after; a.alt = "After";

        pair.appendChild(b);
        pair.appendChild(a);

        const div = document.createElement("div");
        div.className = "viewerDivider";
        pair.appendChild(div);

        // AFTER pulse frame (always on in viewer)
        const shine = document.createElement("div");
        shine.className = "viewerAfterShine";
        pair.appendChild(shine);

        viewer.appendChild(pair);
        modal.classList.add("open");
      }
    }

    function closeViewer(){
      modal.classList.remove("open");
      viewer.innerHTML = "";
      currentIndex = -1;
    }

    closeBtn.addEventListener("click", () => { softClick(); closeViewer(); });
    modal.addEventListener("click", (e) => { if(e.target === modal){ softClick(); closeViewer(); } });

    window.addEventListener("keydown", (e) => {
      if(e.key === "Escape"){
        if(modal.classList.contains("open")) closeViewer();
        if(contactOverlay.classList.contains("open")) closeContact();
      }
      if(!modal.classList.contains("open")) return;

      if(e.key === "ArrowRight") nav(1);
      if(e.key === "ArrowLeft") nav(-1);
    });

    function nav(dir){
      if(currentIndex < 0) return;
      const next = currentIndex + dir;
      if(next < 0 || next >= visibleItems.length) return;
      openViewer(visibleItems[next], next);
      softClick();
    }

    render();
  </script>
</body>
</html>
